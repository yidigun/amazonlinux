#cloud-config
#vim:syntax=yaml
users:
- default
- name: dagui
  gecos: Daekyu Lee
  groups: [adm, wheel, systemd-journal]

chpasswd:
  list: |
    ec2-user:1234
    dagui:1234
    root:1234

write_files:
  - path: /etc/cloud/cloud.cfg.d/80_disable_network_after_firstboot.cfg
    content: |
      network:
        config: disabled
  - path: /authorized_keys
    content: |
      ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDAEeZrFLc5i3fKptezuTKOmmSmhQ+bEsHltgCpt6TfGmie3Ci+o+4W7N4iVwBp898C7XNvT3MKxjauxY0/aqEvJeq5/Z8CqaPuPpvvxTRHWNfxYdvOEysaCxVLQtADytEI7mKnv6ZoiSV+Zo/emqcTx6H4VdqBp5CTDe8FKMNbGt8ZBwoeunwof+LziziO4a8DNUcIvGh2+GONDPxwGdNHuOHvieoqQLaHAyhWrGbzVc6D3NB7uCeyFR6JWY1On8fSLW4BwODRlomW5LK8LpuMsi66E4WepX8JO+14wvZktOpZlPsERrrEkmkGa9McZJW1ydP5NbzlD/EWRMUmj97yzHbMLDGV1y8NKG3EMDv19SMM+riqFj19WoyrJWj1VjK1Xk2GG2pd0nvg0RTFW2QoWyZOh/3obc0lI5wD7iAzoJ8/yXD1m3hVwkoxRAocZnzBIu6OEZIkV1jZaxWZaExxcSq5E9yN00nvOwypcgKzBegt4/bFZp8ryYbLJp+X958= dagui@yidigun.local
    permissions: "0600"

locale: ko_KR

timezone: Asia/Seoul

runcmd:
- localectl set-locale LANG=ko_KR.utf8
- echo "LANG=ko_KR.utf8" > /etc/locale.conf
- echo "LANG=ko_KR.utf8" > /etc/sysconfig/i18n.conf
- echo "nameserver 8.8.8.8" >> /etc/resolv.conf
- echo "nameserver 8.8.4.4" >> /etc/resolv.conf
- sed -i -e /^PasswordAuthentication/s/no/yes/ /etc/ssh/sshd_config
- mkdir -p ~dagui/.ssh
- cp -p /authorized_keys ~dagui/.ssh/authorized_keys
- chmod -R g-rwx,o-rwx ~dagui/.ssh
- chown -R dagui:dagui ~dagui/.ssh
- systemctl restart sshd
